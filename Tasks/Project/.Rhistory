setwd('~/Desktop/Evolution/Tasks/Task_08')
library(phytools)
library("phytools")
trees<-list()
births<-vector()
Fractions<-vector()
for(i in 1:100){
runif(1,min=1,max=100)
births[[i]]<-runif(1,min=1,max=100)
runif(1,min=1,max=100)
Fractions[[i]]<-runif(1,min=1,max=100)
}
?pbtree
for(i in 1:100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(n=100,b=birth[i],d=(births[i]*Fractions[i]))
}
setwd('~/Desktop/Evolution/Tasks/Task_08')
library("phytools")
trees<-list()
births<-vector()
Fractions<-vector()
?pbtree
for(i in 1:100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(n=100,b=birth[i],d=(births[i]*Fractions[i]))
}
for(i in 1:100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(n=100,b=births[i],d=(births[i]*Fractions[i]))
}
plot(trees[[i]])
logs<-log(sapply(trees,Ntip))
for(i in 1:100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(n=100,b=births[i],d=(births[i]*Fractions[i]))
}
#Question 4
plot(trees[[i]])
#Question 4
plot(trees[[i]])
plot(trees[[i]])
logs<-log(sapply(trees,Ntip))
netdiv<-(births-Fractions)
plot(netdiv, logs)
netdiv<-(births-(births[i]*Fractions[i]))
netdiv<-(births-(births*Fractions))
plot(netdiv, logs)
plot(trees[[i]])
tips<-log(sapply(trees,Ntip))
netdiv<-(births-(births*Fractions))
plot(netdiv, logs)
plot(netdiv, tips)
#Question 5
avgbranchlength<-vector()
births[[i]]<-runif(1)
Fractions[[i]]<-runif(1)}
Fractions[[i]]<-runif(1)
trees[[i]]<-pbtree(n=100,b=births[[i]],d=(births[[i]]*Fractions[i]))
avgbranchlength[i]<-mean(trees[[i]]4edge.length)
avgbranchlength[i]<-mean(trees[[i]]$edge.length)
for(i in 1:100){
births[[i]]<-runif(1)
Fractions[[i]]<-runif(1)
trees[[i]]<-pbtree(n=100,b=births[[i]],d=(births[[i]]*Fractions[i]))
avgbranchlength[i]<-mean(trees[[i]]$edge.length)
}
plot(births, avgbranchlength,xlab="speciation rate",ylab="average branch length")
#Question 6
cor(births, avgbranchlength)
#Question 7
largest_tree<-tree[[whic.max(sapply(trees,length))]]
Tree<-largest_tree
#Question 7
largest_tree<-trees[[whic.max(sapply(trees,length))]]
#Question 7
largest_tree<-trees[[which.max(sapply(trees,length))]]
Tree<-largest_tree
plot(Tree)
dev.off()
rates<-c()
traits<-list()
for(i in 1:100){
rates[i]<-runif(1)
}
rates[i]<-runif(1)
traits[[i]]<-fastBM(tree=Tree,sig2=rates[i])
for(i in 1:100){
rates[i]<-runif(1)
traits[[i]]<-fastBM(tree=Tree,sig2=rates[i])
}
plot(Tree)
#Question 8
mean_traits<-sapply(traits,mean)
cor(mean_traits,rates)
#The correlation is -0.0138 which means there is a very weak negative correlation.
plot(rates,var_traits,xlab="Rates",ylab="Variance of traits")
#The correlation is -0.0138 which means there is a very weak negative correlation.
plot(rates,mean_traits,xlab="Rates",ylab="Variance of traits")
dev.off()
#Question 9
var_traits<-sapply(traits,var)
cor(var_traits,rates)
#The correlation is 0.7343654 which means there is a strong correlation.
plot(rates,var_traits,xlab="Rates",ylab="Variance of traits")
dev.off()
#Question 10
cor(traits[[1]],traits[[2]])
#The correlation is 0.1284441 which means there is a weak positive correlation.
traitMat<-cbind(traits[[1]],traits[[4]])
plot(traitMat)
pdf("08_plot.pdf")
plot(traitMat)
pdf("08_plot.pdf")
plot(traitMat)
dev.off()
#Extra Credit
phylomorphospace(Tree,traitMat,xlab="Trait 1",ylab="Trait 2")
pdf("08_ec.pdf")
phylomorphospace(Tree,traitMat,xlab="Trait 1",ylab="Trait 2")
dev.off()
names(Cols) <- unique(barn.owls$Lineage)
barn.owls<- read.csv("~/Desktop/Evolution/Tasks/Project/barn owl.csv")
Cols <- c("blue", "green", "purple")
names(Cols) <- unique(barn.owls$Lineage)
head(barn.owls)
plot(barn.owls$Bill, barn.owls$Wing, col=Cols[barn.owls$Lineage], pch=16)
plot(xlab= "Bill Length (mm*10)",ylab="Wing Length (mm)", col=Cols[barn.owls$Lineage], pch=16)
plot(barn.owls$Bill,barn.owls$Wing, xlab= "Bill Length (mm*10)",ylab="Wing Length (mm)", col=Cols[barn.owls$Lineage], pch=16)
log=ylab
log="y"
title("Comparing the Wing and Bill Length Between Species of Barn Owls")
legend(legend=c("T. Alba", "T.Furcata", "T. Javanica"), fill=c("blue","green","purple"))
legend(160, 350, legend=c("T. Alba", "T.Furcata", "T. Javanica"), fill=c("blue","green","purple"))
legend(160, 350, legend=c("T. Alba", "T. Furcata", "T. Javanica"), fill=c("blue","green","purple"))
head(Bill)
pdf("Project.Bill&Wing.pdf")
plot(barn.owls$Bill,barn.owls$Wing, xlab= "Bill Length (mm*10)",ylab="Wing Length (mm)", col=Cols[barn.owls$Lineage], pch=16)
title("Comparing the Wing and Bill Length Between Species of Barn Owls")
legend(160, 350, legend=c("T. Alba", "T. Furcata", "T. Javanica"), fill=c("blue","green","purple"))
dev.off()
setwd('~/Desktop/Evolution/Tasks/Project')
barn.owls<- read.csv("~/Desktop/Evolution/Tasks/Project/barn owl.csv")
pdf("Project.Bill&Wing.pdf")
plot(barn.owls$Bill,barn.owls$Wing, xlab= "Bill Length (mm*10)",ylab="Wing Length (mm)", col=Cols[barn.owls$Lineage], pch=16)
title("Comparing the Wing and Bill Length Between Species of Barn Owls")
legend(160, 350, legend=c("T. Alba", "T. Furcata", "T. Javanica"), fill=c("blue","green","purple"))
dev.off()
plot(log(barn.owls$Bill),log(barn.owls$Wing), xlab= "Bill Length (mm*10)",ylab="Wing Length (mm)", col=Cols[barn.owls$Lineage], pch=16)
title("Comparing the Wing and Bill Length Between Species of Barn Owls")
legend(160, 350, legend=c("T. Alba", "T. Furcata", "T. Javanica"), fill=c("blue","green","purple"))
legend(5.1, 5.9, legend=c("T. Alba", "T. Furcata", "T. Javanica"), fill=c("blue","green","purple"))
abline(lm(log(barn.owls$Bill)~log(barn.owls$Length)),col='red')
abline(lm(log(barn.owls$Bill)~log(barn.owls$Wing)),col='red')
abline(lm(log(barn.owls$Bill)~log(barn.owls$Length)),col='red')
abline(lm(log(barn.owls$Bill),log(barn.owls$Bill)),col='red'))
abline(lm(log(barn.owls$Bill),log(barn.owls$Bill)),col='red')
abline(Im(log(barn.owls$Bill),log(barn.owls$Bill)),col='red')
abline(Im(log(barn.owls$Bill)~log(barn.owls$Bill)),col='red')
abline(lm(log(barn.owls$Bill)~log(barn.owls$Bill)),col='red')
setwd('~/Desktop/Evolution/Tasks/Project')
barn.owls<- read.csv("~/Desktop/Evolution/Tasks/Project/barn owl.csv")
plot(log(barn.owls$Bill),log(barn.owls$Wing), xlab= "Bill Length (mm*10)",ylab="Wing Length (mm)", col=Cols[barn.owls$Lineage], pch=16)
title("Comparing the Wing and Bill Length Between Species of Barn Owls")
legend(5.1, 5.9, legend=c("T. Alba", "T. Furcata", "T. Javanica"), fill=c("blue","green","purple"))
setwd('~/Desktop/Evolution/Tasks/Project')
barn.owls<- read.csv("~/Desktop/Evolution/Tasks/Project/barn owl.csv")
correlation<-cor.test(x=barnowls2$Bill, y=barnowls2$Wing)
barnowls2 <- barn.owls[c(1, 8, 9)]
barnowls2
correlation<-cor.test(x=barnowls2$Bill, y=barnowls2$Wing)
plot(log(barn.owls$Bill),log(barn.owls$Wing), xlab= "Bill Length (mm*10)",ylab="Wing Length (mm)", col=Cols[barn.owls$Lineage], pch=16)
title("Comparing the Wing and Bill Length Between Species of Barn Owls")
legend(5.1, 5.9, legend=c("T. Alba", "T. Furcata", "T. Javanica"), fill=c("blue","green","purple"))
barnowls2 <- barn.owls[c(1, 8, 9)]
barnowls2
correlation<-cor.test(x=barnowls2$Bill, y=barnowls2$Wing)
correlation<-cor.test(x=barn.owls$Bill, y=barn.owls$Wing)
correlation<-cor.test(x=barnowls2$Bill, y=barnowls2$Wing)
correlation
